## Property media & Google Map design

- **New tables/entities**
  - **`PropertyPhoto`**
    - Table: `property_photo`
    - Fields:
      - `id` (PK, auto)
      - `property_id` (FK → `property.id`, many photos per property)
      - `photo_type` (`FRONT`, `LEFT`, `RIGHT`, `INSIDE`, or any free text)
      - `file_path` (MinIO path / URL from `/api/upload`)
      - `display_order` (optional int for UI ordering)
    - Relation in `Property`:
      - `@OneToMany(mappedBy = "property", cascade = ALL, orphanRemoval = true)`
      - Field: `List<PropertyPhoto> photos = new ArrayList<>();`
    - **Nullability/behaviour**
      - Photos list is optional; for a property with no images, the list is empty or null in the request.
      - On update, when `photos` is provided in the request, existing rows are deleted and replaced by the new list.

  - **`PropertyMapInfo`**
    - Table: `property_map_info`
    - Fields:
      - `id` (PK, auto)
      - `property_id` (FK → `property.id`, `unique = true`, one row per property)
      - `draw_line` (TEXT; JSON / encoded polyline of drawn line or polygon)
      - `style` (map style / color string)
      - `latitude` (Double)
      - `longitude` (Double)
      - `document_path` (optional PDF path in MinIO, e.g., property picture & valuation report)
    - Relation in `Property`:
      - `@OneToOne(mappedBy = "property", cascade = ALL, orphanRemoval = true, fetch = LAZY)`
      - Field: `PropertyMapInfo mapInfo;`
    - **Nullability/behaviour**
      - Entire `mapInfo` is optional; all business fields inside are nullable.
      - On create: if `mapInfo` is null in request, no row is inserted.
      - On update: if `mapInfo` is present in request, the row is created/updated with the new values.

- **DTO changes**
  - **`PropertyPhotoDto`**
    - Fields: `id`, `photoType`, `filePath`, `displayOrder`.
    - Used in both request and response. `id` is ignored on create; populated on read.
  - **`PropertyMapInfoDto`**
    - Fields: `id`, `drawLine`, `style`, `latitude`, `longitude`, `documentPath`.
  - **`PropertyRequestDto`**
    - Added:
      - `List<PropertyPhotoDto> photos = new ArrayList<>();` (optional / can be empty or omitted)
      - `PropertyMapInfoDto mapInfo;` (optional / can be null)
  - **`PropertyResponseDto`**
    - Added:
      - `List<PropertyPhotoDto> photos;`
      - `PropertyMapInfoDto mapInfo;`

- **Service behaviour (`PropertyService`)**
  - **Create**
    - After saving `Property`, if `requestDto.getPhotos()` is not null/empty:
      - Create `PropertyPhoto` rows, set `property`, `photoType`, `filePath`, `displayOrder`.
    - If `requestDto.getMapInfo()` is not null:
      - Create `PropertyMapInfo`, set `property`, `drawLine`, `style`, `latitude`, `longitude`, `documentPath`.
  - **Update**
    - Photos:
      - If `requestDto.getPhotos()` is **not null**:
        - Existing `property.getPhotos()` are deleted and cleared.
        - New rows are inserted from the request list (can be empty to mean “remove all photos”).
    - Map info:
      - If `requestDto.getMapInfo()` is **not null**:
        - If property has no `mapInfo`, a new one is created.
        - Otherwise, its fields are overwritten with the values from request (all may be null).
      - If `mapInfo` is omitted from the request, existing map info is left unchanged.
  - **Read**
    - `convertToResponseDto` maps `Property.photos` → `List<PropertyPhotoDto>` and `Property.mapInfo` → `PropertyMapInfoDto`.

- **API usage notes**
  - **Photos**
    - Upload each image to `/api/upload` (MinIO) and store the returned `fullPath` in `filePath`.
    - Example request fragment:
      - `photos: [{ "photoType": "FRONT", "filePath": "20251204/20251204120000.jpg" }]`
  - **Google Map**
    - `drawLine`: JSON/polyline for the shape drawn on the map.
    - `style`: color or custom style string (e.g., `"#ff0000"`).
    - `latitude` / `longitude`: main marker coordinate.
    - `documentPath`: MinIO path of PDF (max size enforcement should be done at upload API).


